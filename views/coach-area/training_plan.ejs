<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Training Plan</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/style.css"/>
</head>
<body class="bg-blue-50 text-gray-800">
  <%- include('../_header') %>
  <main class="container mx-auto p-4">
    <button id="toggleArchive" class="bg-gray-200 px-3 py-1 rounded mb-4">Toggle Completed Drills</button>
    <% trainingSessions.forEach(session=>{ %>
      <section class="mb-8 bg-white p-4 rounded shadow">
        <h3><%= new Date(session.session_date).toLocaleDateString() %> - <%= session.location %></h3>
        <p><%= session.notes %></p>
        <% const incomplete = session.drills.filter(d=>!d.completed); const completed = session.drills.filter(d=>d.completed); %>
        <ul>
          <% incomplete.forEach(drill=>{ %>
            <li class="mb-2 border p-2">
              <%= drill.drill_name %>
              <div class="space-x-2 inline">
                <form action="/coach-area/drills/<%= drill.id %>/complete" method="POST"><button>Complete</button></form>
                <a href="/coach-area/drills/<%= drill.id %>/edit">Edit</a>
                <form action="/coach-area/drills/<%= drill.id %>/delete" method="POST"><button>Delete</button></form>
              </div>
            </li>
          <% }) %>
        </ul>
        <h4>Completed</h4>
        <ul id="archiveList">
          <% completed.forEach(drill=>{ %>
            <li class="mb-2 border p-2 line-through"><%= drill.drill_name %></li>
          <% }) %>
        </ul>
      </section>
    <% }); %>
  </main>
  <script>
    const toggleBtn = document.getElementById('toggleArchive');
    const archiveList = document.getElementById('archiveList');
    toggleBtn.onclick = () => { archiveList.classList.toggle('hidden'); };
  </script>
</body>
</html>